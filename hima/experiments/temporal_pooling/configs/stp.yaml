_type_: stp.synthetic_sequences
project: stp.fast_weights
log: True    # wandb logging, use 'dry' for dummy do-nothing logging to test metrics collection

seed: 42
iterate:
  epochs: 5
  sequences: 5
  elements: 20

data:
  _base_: $_base.dataset.synthetic_sequences.general
  alphabet_size: 200
  encoder:
    _base_: $_base.encoder.random.fixed_sds
    sds: [500, 10]

model:
  api_block: ___
  pipeline:
    - ___.input -> gen.output
    - gen.output -> sp1.feedforward
    - sp1.compute
    - ???.output -> ___.output

blocks:
  ___:
    _type_: block.storage
    input_sds: ???
    output_sds: ???
  gen:
    _type_: block.storage
  sp1:
    _base_: custom_sp.default
    sp_type: vectorized
    output_sds: [500, 10]
    initial_rf_sparsity: 0.2
    max_rf_sparsity: 0.1
    max_rf_to_input_ratio: 0.5
#    learning_rate_inc: 0.1
    learning_rate_inc: 0.02
#    learning_rate_dec: 0.01
    learning_rate_dec: 0.005
    newborn_pruning_cycle: 5
    newborn_pruning_stages: 3
    boosting_k: 2.0

log_schedule:
  log_repeat_schedule: 3
  log_epoch_schedule: 2

iterate_setups:
  simple: ...

custom_sp:
  default:
    _type_: sp.custom
    seed: ???
    # input
    feedforward_sds: ???
    initial_rf_sparsity: 0.3
    max_rf_sparsity: 0.1
    max_rf_to_input_ratio: 2.5
    # output
    output_sds: ???
    # learning
    min_overlap_for_activation: 3
    learning_rate_inc: 0.1
    learning_rate_dec: 0.01
