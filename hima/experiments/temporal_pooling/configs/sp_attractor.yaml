_type_: stp_experiment.sp_attractor.mnist
project: stp.sp_attractor
log: True    # wandb logging, use 'dry' for dummy do-nothing logging to test metrics collection

seed: 42
iterate:
  _base_: iterate_setups.small

testing:
  _base_: testing_setups.mnist

encoder: sp.encoder
attractor: sp.attractor
env: envs.random_bits

testing_setups:
  mnist:
    attractor_steps: 10
    n_trajectories: 500
    learn_attractor_in_loop: False
    pairs_per_trajectory: 10
  rand_bits:
    attractor_steps: 10
    n_trajectories: 500
    learn_attractor_in_loop: True
    pairs_per_trajectory: 1

envs:
  random_bits:
    sds: [64, 0.375]
    similarity_range: [0, 1]

sp:
  encoder:
    _base_: $_base.spatial_pooler.default
    # input
    initial_rf_to_input_ratio: 8.0
    max_rf_to_input_ratio: 1.5
    # output
    output_sds: [500, 16]
    # learning
    learning_rate: 0.02
    global_inhibition_strength: 0.2
    newborn_pruning_cycle: 2.0
    prune_grow_cycle: 100.0
    newborn_pruning_stages: 10
    adapt_to_ff_sparsity: True
    boosting_k: 0.5

  attractor:
    _base_: $_base.spatial_pooler.default
    # input
    initial_rf_to_input_ratio: 8.0
    max_rf_to_input_ratio: 1.5
    # output
    output_sds: [500, 16]
    # learning
    learning_rate: 0.02
    global_inhibition_strength: 0.2
    newborn_pruning_cycle: 2.0
    newborn_pruning_stages: 10
    prune_grow_cycle: 100.0
    boosting_k: 0.5

iterate_setups:
  full:
    n_episodes: 1000
    max_steps: 100
    log_schedule: 100
  mid:
    n_episodes: 100
    max_steps: 100
    log_schedule: 10
  small:
    n_episodes: 10
    max_steps: 100
    log_schedule: 5

so_map:
  enabled: false
  iterations: 1000
  learning_rate: 0.1
  sigma: 1.0
  size: 100

wandb_init:
  _base_: $_base.wandb_init

