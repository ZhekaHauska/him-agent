_type_: stp_experiment.se
project: stp.se_mnist
log: True    # wandb logging, use 'dry' for dummy do-nothing logging to test metrics collection

seed: 42
#output_sds: [2000, 40]
#output_sds: [1000, 20]
output_sds: [400, 10]
setup: setups.binary_basic_sp

train:
  n_epochs: 5
test:
  eval_schedule: 4
  n_epochs: 10
  batch_size: 64

classifier:
  feedforward_sds: ???
  n_classes: ???
  learning_rate: 0.0001
  collect_losses: 1000

sp:
  htm_sp:
    _type_: sp.htm
    seed: ???
    feedforward_sds: ???
    output_sds: ???
    potential_synapses_ratio: 0.6
    synapse_permanence_deltas: [0.1, 0.01]
    connected_permanence_threshold: 0.5
    boost_strength: 0.5
    boost_sliding_window: 10_000
    expected_normal_overlap_frequency: 0.001
  basic_sp:
    _base_: _common_base
    output_sds: ???
    target_rf_to_input_ratio: 0.3
#    target_rf_to_input_ratio: 2.0
    newborn_pruning_cycle: 40.0
    newborn_pruning_stages: 20

  sng_sp:
    _type_: sp.layer
    seed: ???
    # input
    feedforward_sds: ???

    rf_sparsity: 0.6
    rf_to_input_ratio: 0.3
#    rf_to_input_ratio: 0.8

    # learning
    learning_rate: 0.01
    learning_algo: new
    synaptogenesis_cycle: 200.0

    # output
    output_sds: ???
    output_mode: binary

  _common_base:
    _base_: $_base.spatial_pooler.default
    # input
    target_max_rf_sparsity: 0.4
    initial_rf_to_input_ratio: 8.0
    # learning
    learning_rate: 0.02
    newborn_pruning_cycle: 10.0
    newborn_pruning_stages: 10
    newborn_pruning_mode: powerlaw
    prune_grow_cycle: 200.0
    adapt_to_ff_sparsity: True
    boosting_k: 1.0

setups:
  binary_htm_sp:
    encoder: sp.htm_sp
    input_mode: binary
  binary_basic_sp:
    encoder: sp.basic_sp
    input_mode: binary
  binary_ann:
    input_mode: binary
    second_layer: True
  rate_ann:
    input_mode: rate
    second_layer: True
  binary_sng_sp:
    encoder:
      _base_: sp.sng_sp
      output_mode: rate
    input_mode: binary
  rate_sng_sp:
    encoder:
      _base_: sp.sng_sp
      output_mode: rate
    input_mode: rate

sdr_tracker:
  _type_: tracker.sdr
  sds: ???

wandb_init:
  _base_: $_base.wandb_init

